macros:
  - inputs:
      - column
    name: macro_datediff
    value: '{% if !(end_time|isnil) %} datediff(day, date({{column}}), date(''{{end_time.Format("2006-01-02 15:04:05")}}'')) {% else %} datediff(day, date({{column}}::timestamp), GETDATE()) {% endif %}'
  - inputs:
      - column
      - number_of_days
    name: macro_datediff_n
    value: '{% if !(end_time|isnil) %} datediff(day, date({{column}}), date(''{{end_time.Format("2006-01-02 15:04:05")}}'')) <={{number_of_days}} {% else %} datediff(day, date({{column}}), GETDATE()) <= {{number_of_days}} {% endif %}'

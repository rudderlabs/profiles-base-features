macros:
  - name: array_agg
    inputs:
      - column_name
    value: "array_agg( distinct {{column_name}})"
  - name: array_size
    inputs:
      - column_name
    value: "array_size( parse_json({{column_name}}) )"
  - name: frame_clause  
    
    value: "frame_condition = 'rows between unbounded preceding and unbounded following')"
    
  - name: lag_col
    inputs:
      - column_name
    value: "lag({{column_name}}, 1, {{column_name}}))"